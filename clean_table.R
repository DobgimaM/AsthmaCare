# This code cleans the tables

c(p_age1, p_age2, p_age3, p_Fem1, p_Fem2, p_Fem3, p_Nvsmk1,
  p_Nvsmk2, p_Nvsmk3, p_IMDq1, p_IMDq2, p_IMDq3, p_Inc1, p_Inc2,
  p_Inc3, p_EmReSt1, p_EmReSt2, p_EmReSt3, p_BMI1, p_BMI2, p_BMI3,
  p_BMI301, p_BMI302, p_BMI303, p_ExM1, p_ExM2, p_ExM3, p_apFin1,
  p_apFin2, p_apFin3, p_apCrs1, p_apCrs2, p_apCrs3, p_NO21, p_NO22, p_NO23,
  p_NOx1, p_NOx2, p_NOx3, p_Hyp1, p_Hyp2, p_Hyp3, p_PainC1, p_PainC2, p_PainC3,
  p_Dys1, p_Dys2, p_Dys3, p_Dep1, p_Dep2, p_Dep3, p_Ecz1, p_Ecz2, p_Ecz3,
  p_Asth_age1, p_Asth_age2, p_Asth_age3, p_SABA1, p_SABA2, p_SABA3,
  p_ICS1, p_ICS2, p_ICS3, p_OCS1, p_OCS2, p_OCS3, p_pkflw1, p_pkflw2, p_pkflw3,
  p_FEV11, p_FEV12, p_FEV13, p_FEVlln1, p_FEVlln2, p_FEVlln3, p_FVC1, p_FVC2, p_FVC3,
  p_ffratio1, p_ffratio2, p_ffratio3, p_Eos1, p_Eos2, p_Eos3, p_Eos3001, p_Eos3002,
  p_Eos3003, p_AstHos1, p_AstHos2, p_AstHos3)


c(NA, p_age1, p_Fem1, p_Nvsmk1, p_IMDq1,rep('NA',4), p_UniEd1, p_Inc1,
  NA, p_EmReSt1, p_BMI1, p_BMI301, p_ExM1, NA, p_apFin1,
  p_apCrs1, p_NO21, p_NOx1, p_Hyp1,
  p_PainC1, p_Dys1, p_Dep1, p_Ecz1, NA, p_Asth_age1, p_SABA1, 
  p_ICS1, p_OCS1, p_pkflw1, p_FEV11, p_FEVlln1, p_FVC1,
  p_ffratio1, p_Eos1, p_Eos3001, p_AstHos1)


A <- c(NA, p_age1, p_Fem1, p_Nvsmk1, p_IMDq1,rep(NA,4), p_Inc1,p_UniEd1,
       p_EmReSt1, p_BMI1, p_BMI301, p_ExM1, p_apFin1,
       p_apCrs1, p_NO21, p_NOx1, p_Hyp1,
       p_PainC1, p_Dys1, p_Dep1, p_Ecz1, p_Nasth11, p_Asth_age1, p_SABA1, 
       p_ICS1, p_OCS1, p_pkflw1, p_FEV11, p_FEVlln1, p_FVC1,
       p_ffratio1, p_Eos1, p_Eos3001, p_AstHos1)

B <- c('Number of participants', 'Age (years)', 'Female','Never smoker',
       'IMD1 quintile', 'IMD2','IMD3', 'IMD4', 'IMD5', 'Income ≥£31000', 'University educated',
       'Employed / retired / student', 'Body mass index (BMI)','>30 kg/m2','Excess MET hours','ap_Fine (PM2.5)',
       'Coarse (PM10)', 'Nitrogen dioxide (NO2)', 'Nitrogen oxides (NOx)','Hypertension',
       'Painful conditions', 'Dyspepsia', 'Depression', 'Psoriasis / eczema', '≥1 Non-asthma disease','Age asthma diagnosed','SABA',
       'ICS', 'OCS', 'Peak flow (%)', 'FEV1 (%)','<LLN', 'FVC (%)', 
       'FEV1/FVC (%)', 'Eosinophil count (cells/μl)', '≥ 300/μl','Asthma hospitalisation')

# cbind(B,A) %>% view()

tables_of_results1 <- data.frame(
  Variables = c('Number of participants', 'Age (years)', 'Female','Never smoker',
                'IMD1 quintile', 'IMD2','IMD3', 'IMD4', 'IMD5', 'Income ≥£31000',
                'University educated','Employed / retired / student', 
                'Body mass index (BMI)','>30 kg/m2','Excess MET hours','ap_Fine (PM2.5)',
                'Coarse (PM10)', 'Nitrogen dioxide (NO2)', 
                'Nitrogen oxides (NOx)','Hypertension','Painful conditions', 'Dyspepsia', 
                'Depression', 'Psoriasis / eczema', '≥1 Non-asthma disease','Age asthma diagnosed','SABA', 'ICS',
                'OCS', 'Peak flow (%)', 'FEV1 (%)','<LLN', 'FVC (%)', 'FEV1/FVC (%)', 
                'Eosinophil count (cells/μl)', '≥ 300/μl','Asthma hospitalisation'),
  White = c(t4[1,1],
            paste0(t4[2,1],' (', t4[3,1], ')'),
            paste0(t4[4,1],' (',df_perc[1,2],'%)'),
            paste0(t4[5,1],' (',df_perc[2,2],'%)'),
            paste0(df2[1,1],' (',df_perc[3,2],'%)'),
            paste0(df2[2,1],' (',df_perc[4,2],'%)'),
            paste0(df2[3,1],' (',df_perc[5,2],'%)'),
            paste0(df2[4,1],' (',df_perc[6,2],'%)'),
            paste0(df2[5,1],' (',df_perc[7,2],'%)'),
            paste0(t4[6,1],' (',df_perc[8,2],'%)'),
            paste0(df2[6,1],' (',df_perc[9,2],'%)'),
            paste0(df2[7,1],' (',df_perc[10,2],'%)'),
            paste0(t4[7,1],' (',df2[9,1],'%)'),
            paste0(df2[8,1],' (',df_perc[11,2],'%)'),
            paste0(t4[9,1],' (',df2[10,1],', ', df2[11,1],')'),
            paste0(t4[10,1],' (',t4[11,1], ')'),
            paste0(t4[12,1],' (',t4[13,1], ')'),
            paste0(t4[14,1],' (',t4[15,1], ')'),
            paste0(t4[16,1],' (',t4[17,1], ')'),
            paste0(t4[18,1],' (',df_perc[12,2], '%)'),
            paste0(t4[19,1],' (',df_perc[13,2], '%)'),
            paste0(t4[20,1],' (',df_perc[14,2], '%)'),
            paste0(t4[21,1],' (',df_perc[15,2], '%)'),
            paste0(t4[22,1],' (',df_perc[16,2], '%)'),
            paste0(t4[42,1],' (',df_perc[22,2], '%)'), #c count
            paste0(df2[13,1],' (',df2[14,1], ')'),        # age asthma diagnoses
            paste0(t4[23,1],' (',df_perc[17,2], '%)'),
            paste0(t4[24,1],' (',df_perc[18,2], '%)'),
            paste0(t4[27,1],' (',df_perc[19,2], '%)'),
            paste0(t4[28,1],' (',t4[29,1], ')'),
            paste0(t4[30,1],' (',t4[31,1], ')'),
            paste0(t4[34,1],' (',df2[12,1], ')'),
            paste0(t4[32,1],' (',t4[33,1], ')'),
            paste0(t4[36,1],' (',df_perc[20,2], '%)'),
            paste0(t4[37,1],' (',t4[38,1], ')'),
            paste0(t4[39,1],' (',t4[40,1], ')'),
            paste0(t4[41,1],' (',df_perc[21,2], '%)')
            
  ),
  SEA = c(t4[1,2],
          paste0(t4[2,2],' (', t4[3,2], ')'),
          paste0(t4[4,2],' (',df_perc[1,3],'%)'),
          paste0(t4[5,2],' (',df_perc[2,3],'%)'),
          paste0(df2[1,2],' (',df_perc[3,3],'%)'),
          paste0(df2[2,2],' (',df_perc[4,3],'%)'),
          paste0(df2[3,2],' (',df_perc[5,3],'%)'),
          paste0(df2[4,2],' (',df_perc[6,3],'%)'),
          paste0(df2[5,2],' (',df_perc[7,3],'%)'),
          paste0(t4[6,2],' (',df_perc[8,3],'%)'),
          paste0(df2[6,2],' (',df_perc[9,3],'%)'),
          paste0(df2[7,2],' (',df_perc[10,3],'%)'),
          paste0(t4[7,2],' (',df2[9,2],'%)'),
          paste0(df2[8,2],' (',df_perc[11,3],'%)'),
          paste0(t4[9,2],' (',df2[10,2],', ', df2[11,2],')'),
          paste0(t4[10,2],' (',t4[11,2], ')'),
          paste0(t4[12,2],' (',t4[13,2], ')'),
          paste0(t4[14,2],' (',t4[15,2], ')'),
          paste0(t4[16,2],' (',t4[17,2], ')'),
          paste0(t4[18,2],' (',df_perc[12,3], '%)'),
          paste0(t4[19,2],' (',df_perc[13,3], '%)'),
          paste0(t4[20,2],' (',df_perc[14,3], '%)'),
          paste0(t4[21,2],' (',df_perc[15,3], '%)'),
          paste0(t4[22,2],' (',df_perc[16,3], '%)'),
          paste0(t4[42,2],' (',df_perc[22,3], '%)'), #c count
          paste0(df2[13,2],' (',df2[14,2], ')'),        # age asthma diagnoses
          paste0(t4[23,2],' (',df_perc[17,3], '%)'),
          paste0(t4[24,2],' (',df_perc[18,3], '%)'),
          paste0(t4[27,2],' (',df_perc[19,3], '%)'),
          paste0(t4[28,2],' (',t4[29,2], ')'),
          paste0(t4[30,2],' (',t4[31,2], ')'),
          paste0(t4[34,2],' (',df2[12,2], ')'),
          paste0(t4[32,2],' (',t4[33,2], ')'),
          paste0(t4[36,2],' (',df_perc[20,3], '%)'),
          paste0(t4[37,2],' (',t4[38,2], ')'),
          paste0(t4[39,2],' (',t4[40,2], ')'),
          paste0(t4[41,2],' (',df_perc[21,3], '%)')
          
  ),
  
  P_value = c(NA, p_age1, p_Fem1, p_Nvsmk1, p_IMDq1,rep(NA,4), p_Inc1,p_UniEd1,
              p_EmReSt1, p_BMI1, p_BMI301, p_ExM1, p_apFin1,
              p_apCrs1, p_NO21, p_NOx1, p_Hyp1,
              p_PainC1, p_Dys1, p_Dep1, p_Ecz1, p_Nasth11, p_Asth_age1, p_SABA1, 
              p_ICS1, p_OCS1, p_pkflw1, p_FEV11, p_FEVlln1, p_FVC1,
              p_ffratio1, p_Eos1, p_Eos3001, p_AstHos1),
  
  Black = c(t4[1,2],
            paste0(t4[2,3],' (', t4[3,3], ')'),
            paste0(t4[4,3],' (',df_perc[1,4],'%)'),
            paste0(t4[5,3],' (',df_perc[2,4],'%)'),
            paste0(df2[1,3],' (',df_perc[3,4],'%)'),
            paste0(df2[2,3],' (',df_perc[4,4],'%)'),
            paste0(df2[3,3],' (',df_perc[5,4],'%)'),
            paste0(df2[4,3],' (',df_perc[6,4],'%)'),
            paste0(df2[5,3],' (',df_perc[7,4],'%)'),
            paste0(t4[6,3],' (',df_perc[8,4],'%)'),
            paste0(df2[6,3],' (',df_perc[9,4],'%)'),
            paste0(df2[7,3],' (',df_perc[10,4],'%)'),
            paste0(t4[7,3],' (',df2[9,3],'%)'),
            paste0(df2[8,3],' (',df_perc[11,4],'%)'),
            paste0(t4[9,3],' (',df2[10,3],', ', df2[11,3],')'),
            paste0(t4[10,3],' (',t4[11,3], ')'),
            paste0(t4[12,3],' (',t4[13,3], ')'),
            paste0(t4[14,3],' (',t4[15,3], ')'),
            paste0(t4[16,3],' (',t4[17,3], ')'),
            paste0(t4[18,3],' (',df_perc[12,4], '%)'),
            paste0(t4[19,3],' (',df_perc[13,4], '%)'),
            paste0(t4[20,3],' (',df_perc[14,4], '%)'),
            paste0(t4[21,3],' (',df_perc[15,4], '%)'),
            paste0(t4[22,3],' (',df_perc[16,4], '%)'),
            paste0(t4[42,3],' (',df_perc[22,4], '%)'), #c count
            paste0(df2[13,3],' (',df2[14,3], ')'),        # age asthma diagnoses
            paste0(t4[23,3],' (',df_perc[17,4], '%)'),
            paste0(t4[24,3],' (',df_perc[18,4], '%)'),
            paste0(t4[27,3],' (',df_perc[19,4], '%)'),
            paste0(t4[28,3],' (',t4[29,3], ')'),
            paste0(t4[30,3],' (',t4[31,3], ')'),
            paste0(t4[34,3],' (',df2[12,3], ')'),
            paste0(t4[32,3],' (',t4[33,3], ')'),
            paste0(t4[36,3],' (',df_perc[20,4], '%)'),
            paste0(t4[37,3],' (',t4[38,3], ')'),
            paste0(t4[39,3],' (',t4[40,3], ')'),
            paste0(t4[41,3],' (',df_perc[21,4], '%)')
            
  ),
  P_value = c(NA, p_age2, p_Fem2, p_Nvsmk2, p_IMDq2,rep(NA,4), p_Inc2,p_UniEd2,
              p_EmReSt2, p_BMI2, p_BMI302, p_ExM2, p_apFin2,
              p_apCrs2, p_NO22, p_NOx2, p_Hyp2,
              p_PainC2, p_Dys2, p_Dep2, p_Ecz2, p_Nasth12, p_Asth_age2, p_SABA2, 
              p_ICS2, p_OCS2, p_pkflw2, p_FEV12, p_FEVlln2, p_FVC2,
              p_ffratio2, p_Eos2, p_Eos3002, p_AstHos2),
  
  NEA = c(t4[1,4],
          paste0(t4[2,4],' (', t4[3,4], ')'),
          paste0(t4[4,4],' (',df_perc[1,5],'%)'),
          paste0(t4[5,4],' (',df_perc[2,5],'%)'),
          paste0(df2[1,4],' (',df_perc[3,5],'%)'),
          paste0(df2[2,4],' (',df_perc[4,5],'%)'),
          paste0(df2[3,4],' (',df_perc[5,5],'%)'),
          paste0(df2[4,4],' (',df_perc[6,5],'%)'),
          paste0(df2[5,4],' (',df_perc[7,5],'%)'),
          paste0(t4[6,4],' (',df_perc[8,5],'%)'),
          paste0(df2[6,4],' (',df_perc[9,5],'%)'),
          paste0(df2[7,4],' (',df_perc[10,5],'%)'),
          paste0(t4[7,4],' (',df2[9,4],'%)'),
          paste0(df2[8,4],' (',df_perc[11,5],'%)'),
          paste0(t4[9,4],' (',df2[10,4],', ', df2[11,4],')'),
          paste0(t4[10,4],' (',t4[11,4], ')'),
          paste0(t4[12,4],' (',t4[13,4], ')'),
          paste0(t4[14,4],' (',t4[15,4], ')'),
          paste0(t4[16,4],' (',t4[17,4], ')'),
          paste0(t4[18,4],' (',df_perc[12,5], '%)'),
          paste0(t4[19,4],' (',df_perc[13,5], '%)'),
          paste0(t4[20,4],' (',df_perc[14,5], '%)'),
          paste0(t4[21,4],' (',df_perc[15,5], '%)'),
          paste0(t4[22,4],' (',df_perc[16,5], '%)'),
          paste0(t4[42,4],' (',df_perc[22,5], '%)'), #c count
          paste0(df2[13,4],' (',df2[14,4], ')'),        # age asthma diagnoses
          paste0(t4[23,4],' (',df_perc[17,5], '%)'),
          paste0(t4[24,4],' (',df_perc[18,5], '%)'),
          paste0(t4[27,4],' (',df_perc[19,5], '%)'),
          paste0(t4[28,4],' (',t4[29,4], ')'),
          paste0(t4[30,4],' (',t4[31,4], ')'),
          paste0(t4[34,4],' (',df2[12,4], ')'),
          paste0(t4[32,4],' (',t4[33,4], ')'),
          paste0(t4[36,4],' (',df_perc[20,5], '%)'),
          paste0(t4[37,4],' (',t4[38,4], ')'),
          paste0(t4[39,4],' (',t4[40,4], ')'),
          paste0(t4[41,4],' (',df_perc[21,5], '%)')
          
  ),
  P_value = c(NA, p_age3, p_Fem3, p_Nvsmk3, p_IMDq3,rep(NA,4), p_Inc3,p_UniEd3,
              p_EmReSt3, p_BMI3, p_BMI303, p_ExM3, p_apFin3,
              p_apCrs3, p_NO23, p_NOx3, p_Hyp3,
              p_PainC3, p_Dys3, p_Dep3, p_Ecz3, p_Nasth13, p_Asth_age3, p_SABA3, 
              p_ICS3, p_OCS3, p_pkflw3, p_FEV13, p_FEVlln3, p_FVC3,
              p_ffratio3, p_Eos3, p_Eos3003, p_AstHos3)
  
)
view(tables_of_results1)


file.edit('test.R')
